<% provide(:title, @user.name) %>

<h3>Groups</h3>

<% @group.each do |g| %>
<!-- how to check if user has attendance? -->

<div class="panel panel-info">
  <div class="panel-heading"><%= g.title %> | <%= g.when %>
  <span class="btn-group">
  <!-- if user has not claimed it/// -->
  <% if !current_user.attendances.find_by(group_id: g.id) %>


    <%= form_for(current_user.attendances.build(group_id: g.id)) do |f| %>
    <div><%= hidden_field_tag :group_id, g.id %></div>
    <%= f.submit "Reserve", class: "btn btn-primary btn-xs" %>
    <% end %>
  <!-- ///if user has not claimed it -->
  <% else %> 
  <!-- if user has claimed it show cancellation -->  
    <%= form_for(current_user.attendances.find_by(user_id: current_user.id), html: { method: :delete }) do |f| %>
    <%= f.submit "Cancel", class: "btn btn-danger btn-xs" %>
    <% end %>

  <% end %>

   </span>

  </div>
  <div class="panel-body">
  <%= g.content %>
  </div>
  <div class="panel-footer">
  Spots Left <span class="badge"><%= g.seats %></span>
  | People Going: 
  <% g.attendances.all.each do |gg| %>
  <%= User.find(gg.user_id).name %>
  <% end %>
  <br>
</div>
</div>

<% end %>